<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Restroom Place</title>
  <style media="screen">
  </style>
</head>

<body>
  <header>
    <h1>Restroom Place</h1>
    <p>Verify you are not a robot and generate room wildcard QR sticker</p>
  </header>
  <main>
    <form id="generate-room" method="POST">
      <label>
        <span>Note:</span>
        <input type="text" name="note" placeholder="Note" />
      </label>
      <button type="submit">Generate</button>
    </form>
  </main>
  <script type="module">
    // Note: Imports has to be from https://www.gstatic.com/, otherwise COmponents like auth and firestore wont work together
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.4.1/firebase-app.js";
    import { initializeAuth, onAuthStateChanged, signInAnonymously } from 'https://www.gstatic.com/firebasejs/9.4.1/firebase-auth.js';
    import { getFirestore, collection, getDocs } from 'https://www.gstatic.com/firebasejs/9.4.1/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "AIzaSyBeH_RDEDJj_63xSc3LGrCvgMiCV3dT-Tg",
      authDomain: "restroom-place.firebaseapp.com",
      projectId: "restroom-place",
      storageBucket: "restroom-place.appspot.com",
      messagingSenderId: "746979184762",
      appId: "1:746979184762:web:f9f3767b16f9dedf0febc3"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const auth = initializeAuth(app);

    onAuthStateChanged(auth, user => {
      console.log({user});
     });


    document.querySelector("#generate-room").addEventListener("submit", async event => {
      event.preventDefault();
      const note = event.target.note.value;
      await signInAnonymously(auth).catch(console.error);
      const user = auth.currentUser;
      console.log({user});
    });
  </script>
</body>

</html>